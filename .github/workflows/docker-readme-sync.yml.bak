name: Sync Docker Hub README

on:
  push:
    branches:
      - main
    paths:
      - 'docker/README-*.md'
      - '.github/workflows/docker-readme-sync.yml'
  workflow_dispatch:

jobs:
  sync-server-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Docker Hub Description - Server
        uses: peter-evans/dockerhub-description@v4
        with:
          username: ${{ secrets.DOCKER_HUB_USERNAME }}
          password: ${{ secrets.DOCKER_HUB_TOKEN }}
          repository: sgfoot/k8snet-checker-server
          readme-filepath: ./docker/README-server.md
          short-description: "K8s Network Checker Server - 分布式 Kubernetes 网络监控工具的服务器端"

  sync-client-readme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Docker Hub Description - Client
        uses: peter-evans/dockerhub-description@v4
        with:
          username: ${{ secrets.DOCKER_HUB_USERNAME }}
          password: ${{ secrets.DOCKER_HUB_TOKEN }}
          repository: sgfoot/k8snet-checker-client
          readme-filepath: ./docker/README-client.md
          short-description: "K8s Network Checker Client - 分布式 Kubernetes 网络监控工具的客户端"

